스프링 기초 프로젝트2 & 스프링 시큐리티
----------
>기초 프로젝트에서 스프링 시큐리티와 JWT를 활용한 인증 인가, 게시글에 CRUD 댓글 추가하기

<br>


조건
1. 회원 가입 API
    - 닉네임, 비밀번호, 비밀번호 확인을 request에서 전달받기
    - 닉네임은 `최소 3자 이상, 알파벳 대소문자(a~z, A~Z), 숫자(0~9)`로 구성하기
    - 비밀번호는 `최소 4자 이상이며, 닉네임과 같은 값이 포함된 경우 회원가입에 실패`로 만들기
    - 비밀번호 확인은 비밀번호와 정확하게 일치하기
    - 데이터베이스에 존재하는 닉네임을 입력한 채 회원가입 버튼을 누른 경우 "중복된 닉네임입니다." 라는 에러메세지를 response에 포함하기
2. 로그인 API
    - 닉네임, 비밀번호를 request에서 전달받기
    - 로그인 버튼을 누른 경우 닉네임과 비밀번호가 데이터베이스에 등록됐는지 확인한 뒤, 하나라도 맞지 않는 정보가 있다면 "닉네임 또는 패스워드를 확인해주세요"라는 에러 메세지를 response에 포함하기
3. 로그인 검사
    - `아래 API를 제외하고` 모두 로그인 토큰을 전달한 경우만 정상 response를 전달받을 수 있도록 하기
        - 회원가입 API
        - 로그인 API
        - 게시글 목록 조회 API
        - 게시글 조회 API
        - 댓글 목록 조회 API
    - 로그인 토큰을 전달하지 않은 채로 로그인이 필요한 API를 호출한 경우 "로그인이 필요합니다." 라는 에러 메세지를 response에 포함하기
    - 로그인 토큰을 전달한 채로 로그인 API 또는 회원가입 API를 호출한 경우 "이미 로그인이 되어있습니다."라는 에러 메세지를 response에 포함하기
4.  댓글 목록 조회 API
    - 로그인 토큰을 전달하지 않아도 댓글 목록 조회가 가능하도록 하기
    - 조회하는 게시글에 작성된 모든 댓글을 목록 형식으로 response에 포함하기
    - 제일 최근 작성된 댓글을 맨 위에 정렬하기
5. 댓글 작성 API
    - 로그인 토큰을 전달했을 때에만 댓글 작성이 가능하도록 하기
    - 로그인 토큰을 전달하지 않은 채로 댓글 작성란을 누르면 "로그인이 필요한 기능입니다." 라는 에러 메세지를 response에 포함하기
    - 댓글 내용란을 비워둔 채 API를 호출하면 "댓글 내용을 입력해주세요" 라는 에러 메세지를 response에 포함하기
6. 댓글 수정 API
    - 로그인 토큰에 해당하는 사용자가 작성한 댓글만 수정 가능하도록 하기
    - API를 호출한 경우 기존 댓글의 내용을 새로 입력한 댓글 내용으로 바꾸기
7. 댓글 삭제 API
    - 로그인 토큰에 해당하는 사용자가 작성한 댓글만 삭제 가능하도록 하기
8. 회원가입 테스트 코드 작성
    - 회원가입시 구현한 아래 조건을 검사하는 테스트 코드를 작성하기
        - 닉네임은 `최소 3자 이상, 알파벳 대소문자(a~z, A~Z), 숫자(0~9)`로 이루어져 있어야 합니다.
        - 비밀번호는 `최소 4자 이상이며, 닉네임과 같은 값이 포함된 경우 회원가입에 실패`합니다.
        - 비밀번호 확인은 비밀번호와 정확하게 일치해야 합니다.
        - 데이터베이스에 존재하는 닉네임을 입력한 채 회원가입 버튼을 누른 경우 "중복된 닉네임입니다." 라는 에러 메세지를 response에 포함하기
    - 테스트 코드 실행 시 실제로는 데이터베이스에 연결되지 않도록 하기
    - 각 조건 별로 2개 이상의 테스트 케이스가 존재하도록 하기

<br>
DB 테이블 & API 목록

![db](https://user-images.githubusercontent.com/59018674/169964479-b1c3a6a3-ee48-4ca7-b7a3-adb4c4d80d10.png)

<br>
트러블 슈팅
1.Controller 안에 return을 ""로 임시로 해둔 것을 깜빡하고 요청을 계속 보냈다. 요청 처리 이후에 돌아갈 길이 없으니 타임리프 에러가 났다. main으로 돌아가도록 설정해주니 에러가 해결됐다.

2.db 연결할때 url설정을 잘못했다.. 그래서 db가 intellij에서는 확인 가능한데 h2 console에서는 에러가 났다. db 설정을 처음부터 다시 해야겠다.

3.service에서 findById메소드를 사용하면 Optional 타입으로 반환된다. 해당 타입은 null을 포함할 수 있는 객체이기 때문에 변수 선언 후 get()메서드로 값에 직접 접근했다.

<br>

질문 답변
1. 수정, 삭제 API의 request를 어떤 방식으로 사용하셨나요? (param, query, body)
>수정은 PUT을 활용, 삭제는 DELETE를 활용했다.
2. 어떤 상황에 어떤 방식의 request를 써야하나요?
>ajax 콜을 날릴때 json 형식으로 보낸 후 @RequestBody를 통해 값을 받아왔다. 응답은 view와 model을 리턴하거나, @ResponseBody로 객체를 반환했다.
3. RESTful한 API를 설계했나요? 어떤 부분이 그런가요? 어떤 부분이 그렇지 않나요?
>RESTful 이라는 것은 문법이라고 생각했다. 아무리 단어를 많이 알고 있어도 문법에 맞지 않으면 그 언어를 못하는 사람으로 취급 받게 된다. RESTful을 지키지 않았을 때 당연히 프로그램은 잘 동작한다. 너무 잘돌아 간다. 하지만 다른사람이 내 코드를 본다면? 나는 그 사람에게 내 코드를 이해시키기 힘들 것이다. 내 프로젝트에선 CRUD 기능 구현에서 API 명칭을 POST, GET, PUT, DELETE mapping을 사용했다는 점이 RESTful API 규칙을 지켰다고 할 수있다.

<br>
사이트 주소
http://52.79.241.154/


